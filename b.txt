library(tseries)
library(forecast)
data("AirPassengers")
# Basic info
str(AirPassengers)
start(AirPassengers)
# Original series
plot(AirPassengers, main="AirPassengers")
# Stationarity tests
adf.test(AirPassengers)
kpss.test(AirPassengers)
# ----- Multiple Plot Window -----
par(mfrow=c(3,1))
# 1. Log-transformed series
plot(log(AirPassengers), col="brown",
main="Log Transformed Series")
# 2. Seasonal differencing (lag = 12)
plot(diff(log(AirPassengers), lag=12), col="darkgreen",
main="After Seasonal Differencing (lag = 12)")
# 3. Regular + seasonal differencing
plot(diff(diff(log(AirPassengers), lag=12), lag=1), col="blue",
main="After Regular + Seasonal Differencing")
# ----- ARIMA -----
sarima <- auto.arima(AirPassengers, seasonal=TRUE)
summary(sarima)
# Forecast
forecast_sarima <- forecast(sarima, h=12)
plot(forecast_sarima, ylab="Passengers", xlab="Time")
# Residual diagnostics
checkresiduals(sarima)